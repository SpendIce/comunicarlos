meta {
  name: Asignar Tecnico (Operador)
  type: http
  seq: 3
}

post {
  url: {{base_url}}/api/v1/requerimientos/{{id_incidente}}/asignar
  body: json
  auth: inherit
}

headers {
  Authorization: Bearer {{token_operador}}
  Content-Type: application/json
}

body:json {
  {
    "tecnico_id": {{id_tecnico}},
    "comentario": "Asignado a Roberto por disponibilidad."
  }
}

tests {
  test("El status code debe ser 200 OK", function() {
    expect(res.getStatus()).to.equal(200);
  });
  
  test("El estado del requerimiento cambia a ASIGNADO", function() {
    const body = res.getBody();
    expect(body.estado).to.equal("ASIGNADO");
  });
  
  test("El t√©cnico asignado debe ser el correcto", function() {
    const body = res.getBody();
    const idTecnicoEsperado = bru.getEnvVar("id_tecnico");
    expect(body.tecnico_asignado.id).to.equal(parseInt(idTecnicoEsperado));
  });
}
